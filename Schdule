public class UpdateCaseEstimate {

    public static void updateCaseEstimate() {
        // List to store cases that need to be updated
        List<Case> casesToUpdate = new List<Case>();

        // Query cases where estimate_resolution_time__c is less than 12 hours remaining
        for (Case c : [SELECT Id, estimate_resolution_time__c, cause, diagnosis
                        FROM Case 
                        WHERE estimate_resolution_time__c < :DateTime.now().addHours(12)]) {

            // Update estimate_resolution_time__c by adding 7 days
            c.estimate_resolution_time__c = c.estimate_resolution_time__c.addDays(7);
            casesToUpdate.add(c);
        }

        // Update the estimate_resolution_time__c field for all cases meeting the criteria
        if (!casesToUpdate.isEmpty()) {
            update casesToUpdate;
        }

        // Loop through cases again to update fields based on condition
        for (Case c : casesToUpdate) {
            // Check cause and diagnosis fields
            if (c.cause == 'Production not Part of LSEG' && c.diagnosis == 'Content Not available') {
                // Set fields if cause is 'Production not Part of LSEG' and diagnosis is 'Content Not available'
                c.Some_Field__c = 'Value1';
                c.Another_Field__c = 'Value2';
            } else {
                // Set other fields
                c.Some_Field__c = 'OtherValue1';
                c.Another_Field__c = 'OtherValue2';
            }
        }

        // Update the cases with the updated fields
        if (!casesToUpdate.isEmpty()) {
            update casesToUpdate;
        }
    }
}
